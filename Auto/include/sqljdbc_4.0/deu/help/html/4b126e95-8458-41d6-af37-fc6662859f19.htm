<html xmlns:xlink="http://www.w3.org/1999/xlink"
	xmlns:MSHelp="http://msdn.microsoft.com/mshelp"
	xmlns:mshelp="http://msdn.microsoft.com/mshelp"
	xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5"
	xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" />
<META NAME="save" CONTENT="history" />
<title>Verwenden von gespeicherten Prozeduren mit einem
	Rückgabestatus</title>
<meta name="Language" content="de-de" />
<meta name="Microsoft.Help.Id"
	content="4b126e95-8458-41d6-af37-fc6662859f19" />
<meta name="Description"
	content="Bei einer aufrufbaren gespeicherten SQL Server-Prozedur handelt es sich um eine Prozedur, die einen Status- oder Ergebnisparameter zurückgibt." />
<meta name="Microsoft.Help.ContentType" content="Concepts" />
<link rel="stylesheet" type="text/css" href="../local/Classic.css" />
<script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script>
<script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script>
</head>
<body>
	<div id="header">
		<table id="bottomTable" cellpadding="0" cellspacing="0">
			<tr>
				<td align="left"><span id="headerBold">Verwenden von
						gespeicherten Prozeduren mit einem Rückgabestatus</span></td>
			</tr>
		</table>
		<table id="gradientTable">
			<tr>
				<td class="nsrBottom" background="../icons/gradient.gif" />
			</tr>
		</table>
	</div>
	<div id="mainSection">
		<div id="mainBody">
			<div class="introduction">
				<p>
					Bei einer aufrufbaren gespeicherten SQL Server-Prozedur handelt es
					sich um eine Prozedur, die einen Status- oder Ergebnisparameter
					zurückgibt. Damit wird normalerweise ermittelt, ob die gespeicherte
					Prozedur erfolgreich ausgeführt wurde oder fehlgeschlagen ist.
					Microsoft JDBC Driver für SQL Server enthält die <a
						href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a>-Klasse,
					mit der Sie diese Art von gespeicherter Prozedur aufrufen und die
					zurückgegebenen Daten verarbeiten können.
				</p>
				<p>
					Wenn Sie diese Art von gespeicherter Prozedur mit dem JDBC-Treiber
					aufrufen, müssen Sie die <span class="code">call</span>-SQL-Escapesequenz
					zusammen mit der <a href="265b024c-898a-4bd0-98b5-f06076717b9e.htm">prepareCall</a>-Methode
					der <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>-Klasse
					verwenden. Die Syntax für die <span class="code">call</span>-Escapesequenz
					mit einem Rückgabestatusparameter lautet wie folgt:
				</p>
				<p>
					<span class="code">{[?=]call
						procedure-name[([parameter][,[parameter]]...)]}</span>
				</p>
				<div style="margin: .5em 1.5em .5em 1.5em">
					<b></b>
					<p>
						Weitere Informationen zu SQL-Escapesequenzen finden Sie unter <span
							sdata="link"><a
							href="00f9e25a-088e-4ac6-aa75-43eacace8f03.htm">Verwenden von
								SQL-Escapesequenzen</a></span>.
					</p>
				</div>
				<p>
					Geben Sie die Rückgabestatusparameter beim Erstellen der<span
						class="code"> call </span>-Escapesequenz mit dem Fragezeichen (?)
					an. das als Platzhalter für den Parameterwert fungiert, der von der
					gespeicherten Prozedur zurückgegeben wird. Um einen Wert für einen
					Rückgabestatusparameter anzugeben, müssen Sie vor dem Ausführen der
					gespeicherten Prozedur den Datentyp des Parameters mit der <a
						href="82f8d608-efc1-4af8-a985-ec25d19420aa.htm">registerOutParameter</a>-Methode
					der <b>SQLServerCallableStatement</b>-Klasse angeben.
				</p>
				<div style="margin: .5em 1.5em .5em 1.5em">
					<b></b>
					<p>
						Wenn der JDBC-Treiber mit einer SQL Server-Datenbank verwendet
						wird, handelt es sich bei dem Wert, der in der <b>registerOutParameter</b>-Methode
						für den Rückgabestatusparameter angegeben wird, immer um einen
						integer-Wert. Dies können Sie mit dem Datentyp <b>java.sql.Types.INTEGER</b>
						angeben.
					</p>
				</div>
				<p>
					Wenn Sie an die <b>registerOutParameter</b>-Methode einen Wert für
					einen Rückgabestatusparameter übergeben, müssen Sie darüber hinaus
					nicht nur den Datentyp für den Parameter angeben, sondern auch die
					ordinale Position des Parameters im Aufruf der gespeicherten
					Prozedur. Für den Rückgabestatusparameter ist die ordinale Position
					immer 1, da es sich immer um den ersten Parameter im Aufruf der
					gespeicherten Prozedur handelt. Obwohl die <b>SQLServerCallableStatement</b>-Klasse
					die Verwendung des Namens eines Parameters zum Angeben dieses
					Parameters unterstützt, können Sie für Rückgabestatusparameter nur
					die Ordnungspositionsnummer verwenden.
				</p>
				<p>Erstellen Sie als Beispiel die folgende Prozedur in der SQL
					Server 2005 AdventureWorks-Beispieldatenbank:</p>
				<div class="sampleCode">
					<span codeLanguage="other"><pre>CREATE PROCEDURE CheckContactCity
   (@cityName CHAR(50))
AS
BEGIN
   IF ((SELECT COUNT(*)
   FROM Person.Address
   WHERE City = @cityName) &gt; 1)
   RETURN 1
ELSE
   RETURN 0
END</pre></span>
				</div>
				<p>Diese gespeicherte Prozedur gibt abhängig davon, ob der im
					cityName-Parameter angegebene Ort in der Person.Address-Tabelle
					gefunden wurde, den Statuswert 1 oder 0 zurück.</p>
				<p>
					Im folgenden Beispiel werden eine offene Verbindung zur
					AdventureWorks-Beispieldatenbank an die Funktion übergeben und die
					gespeicherte Prozedur "CheckContactCity" mit der <a
						href="e1367f39-23d7-4e26-b160-6d988d7e6988.htm">execute</a>-Methode
					aufgerufen:
				</p>
				<div name="snippetGroup">
					<div class="sampleCode">
						<span codeLanguage="Java"><pre>public static void executeStoredProcedure(Connection con) {
   try {
      CallableStatement cstmt = con.prepareCall("{? = call dbo.CheckContactCity(?)}");
      cstmt.registerOutParameter(1, java.sql.Types.INTEGER);
      cstmt.setString(2, "Atlanta");
      cstmt.execute();
      System.out.println("RETURN STATUS: " + cstmt.getInt(1));
      cstmt.close();
   }
   catch (Exception e) {
      e.printStackTrace();
   }
}

</pre></span>
					</div>
				</div>
			</div>
			<span id="seeAlsoSpan"><h1 class="heading">Siehe auch</h1></span>
			<div id="seeAlsoSection" class="section" name="collapseableSection"
				style="">
				<div class="seeAlsoStyle">
					<span sdata="link"><a
						href="0041f9e1-09b6-4487-b052-afd636c8e89a.htm">Verwenden von
							Anweisungen mit gespeicherten Prozeduren</a></span>
				</div>
			</div>
		</div>
		<div id="footer" class="section">
			<span id="feedbackarea">Senden Sie Microsoft <a
				href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dVielen%20Dank%20für%20Ihr%20Feedback.%20Die%20Autorenteams%20im%20Bereich%20Entwicklung%20nutzen%20Ihr%20Feedback,%20um%20die%20Dokumentation%20zu%20verbessern.%20Im%20Rahmen%20der%20Überprüfung%20Ihres%20Feedbacks%20erhalten%20Sie%20von%20uns%20ggf.%20eine%20E-Mail%20mit%20Rückfragen%20oder%20Feedback%20zur%20möglichen%20Lösung.%20Ihre%20E-Mail-Adresse%20wird%20von%20uns%20nicht%20zu%20anderen%20Zwecken%20verwendet%20und%20wird%20gelöscht,%20sobald%20die%20Überprüfung%20Ihres%20Feedbacks%20abgeschlossen%20ist.%0\AWeitere%20Informationen%20zu%20den%20Datenschutzrichtlinien%20von%20Microsoft%20finden%20Sie%20unter%20http://privacy.microsoft.com/de-de/default.aspx.%0\A%0\d','Kundenfeedback');">Feedback</a>
				zu diesem Thema.
			</span><span id="copyrightarea"><p>
					<a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012
						Microsoft. Alle Rechte vorbehalten.</a>
				</p></span>
		</div>
	</div>
</body>
</html>