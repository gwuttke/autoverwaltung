<html xmlns:xlink="http://www.w3.org/1999/xlink"
	xmlns:MSHelp="http://msdn.microsoft.com/mshelp"
	xmlns:mshelp="http://msdn.microsoft.com/mshelp"
	xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5"
	xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" />
<META NAME="save" CONTENT="history" />
<title>Grundlegendes zu Transaktionen</title>
<meta name="Language" content="de-de" />
<meta name="System.Keywords" content="Transaktionen" />
<meta name="Microsoft.Help.Id"
	content="d3e0414c-6809-4bb1-93b1-4960507faecc" />
<meta name="Description"
	content="Bei Transaktionen handelt es sich um Gruppen von Operationen, die in logische Arbeitseinheiten zusammengefasst sind." />
<meta name="Microsoft.Help.ContentType" content="Concepts" />
<link rel="stylesheet" type="text/css" href="../local/Classic.css" />
<script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script>
<script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script>
</head>
<body>
	<div id="header">
		<table id="bottomTable" cellpadding="0" cellspacing="0">
			<tr>
				<td align="left"><span id="headerBold">Grundlegendes zu
						Transaktionen</span></td>
			</tr>
		</table>
		<table id="gradientTable">
			<tr>
				<td class="nsrBottom" background="../icons/gradient.gif" />
			</tr>
		</table>
	</div>
	<div id="mainSection">
		<div id="mainBody">
			<div class="introduction">
				<p>Bei Transaktionen handelt es sich um Gruppen von Operationen,
					die in logische Arbeitseinheiten zusammengefasst sind. Damit wird
					die Konsistenz und Integrität der einzelnen Aktionen in einer
					Transaktion gesteuert und gewährleistet, falls im System Fehler
					auftreten sollten.</p>
				<p>
					Mit Microsoft JDBC Driver für SQL Server ist eine lokale oder
					verteilte Transaktionsverarbeitung möglich. Transaktionen können
					auch Isolationsstufen verwenden. Weitere Informationen zu den vom
					JDBC-Treiber unterstützten Isolationsstufen finden Sie unter <span
						sdata="link"><a
						href="2c41e23a-da6c-4650-b5fc-b5fe53ba65c3.htm">Grundlegendes
							zu Isolationsstufen</a></span>.
				</p>
				<p>Anwendungen sollten Transaktionen nur entweder mit
					Transact-SQL-Anweisungen oder den vom JDBC-Treiber bereitgestellten
					Methoden steuern. Wenn für die gleiche Transaktion sowohl
					Transact-SQL-Anweisungen als auch JDBC-API-Methoden verwendet
					werden, führt dies möglicherweise zu Problemen, z. B. kann der
					Commit einer Transaktion nicht wie erwartet durchgeführt werden,
					ein unerwarteter Commit oder Rollback der Transaktion wird
					durchgeführt und eine neue Transaktion gestartet, oder es treten
					Ausnahmen wie "Fehler beim Wiederaufnehmen der Transaktion" auf.</p>
			</div>
			<h1 class="heading">Verwenden von lokalen Transaktionen</h1>
			<div id="sectionSection0" class="section" name="collapseableSection"
				style="">
				<p>
					Eine Transaktion wird als lokal angesehen, wenn es sich um eine
					Einphasentransaktion handelt, die von der Datenbank direkt
					verarbeitet wird. Der JDBC-Treiber unterstützt lokale Transaktionen
					über die Methoden der <a
						href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>-Klasse,
					wie z. B. <a href="db1e22d2-e53f-474e-8c99-cb1fff7f491a.htm">setAutoCommit</a>,
					<a href="c7346165-51bf-4844-b64c-29833c147236.htm">commit</a> und <a
						href="7adb6772-4047-4d8e-931d-b3d20eec44b5.htm">rollback</a>.
					Lokale Transaktionen werden normalerweise explizit von der
					Anwendung oder automatisch vom Anwendungsserver für die
					Java-Plattform, Enterprise Edition (Java EE) verwaltet.
				</p>
				<p>
					Im folgenden Beispiel wird eine lokale Transaktion mit zwei
					getrennten Anweisungen im<span class="code"> try </span>-Block
					ausgeführt. Die Anweisungen werden für die
					Production.ScrapReason-Tabelle in der AdventureWorks SQL Server
					2005-Beispieldatenbank ausgeführt. Wenn keine Ausnahmen ausgegeben
					werden, wird ein Commit ausgeführt. Der Code im<span class="code">
						catch </span>-Block führt ein Rollback der Transaktion aus, wenn eine
					Ausnahme ausgelöst wird.
				</p>
				<div name="snippetGroup">
					<div class="sampleCode">
						<span codeLanguage="Java"><pre>public static void executeTransaction(Connection con) {
   try {
      //Switch to manual transaction mode by setting
      //autocommit to false. Note that this starts the first 
      //manual transaction.
      con.setAutoCommit(false);
      Statement stmt = con.createStatement();
      stmt.executeUpdate("INSERT INTO Production.ScrapReason(Name) VALUES('Wrong size')");
      stmt.executeUpdate("INSERT INTO Production.ScrapReason(Name) VALUES('Wrong color')");
      con.commit(); //This commits the transaction and starts a new one.
      stmt.close(); //This turns off the transaction.
      System.out.println("Transaction succeeded. Both records were written to the database.");
   }
   catch (SQLException ex) {
      ex.printStackTrace();
      try {
         System.out.println("Transaction failed.");
         con.rollback();
      }
      catch (SQLException se) {
         se.printStackTrace();
      }
   }
}

</pre></span>
					</div>
				</div>
			</div>
			<h1 class="heading">Verwenden von verteilten Transaktionen</h1>
			<div id="sectionSection1" class="section" name="collapseableSection"
				style="">
				<p>Eine verteilte Transaktion aktualisiert Daten in mindestens
					zwei vernetzten Datenbanken, wobei die wichtigen Eigenschaften der
					Transaktionsverarbeitung (unteilbar, konsistent, isoliert und
					dauerhaft) gewährleistet werden. Die Unterstützung verteilter
					Transaktionen wurde in der optionalen API-Spezifikation von JDBC
					2.0 in die JDBC-API aufgenommen. Die Verwaltung verteilter
					Anwendungen wird normalerweise automatisch vom
					JTS-Transaktions-Manager (Java Transaction Service) in einer Java
					EE-Anwendungsserverumgebung ausgeführt. Microsoft JDBC Driver für
					SQL Server unterstützt jedoch verteilte Transaktionen mit jedem
					JTA-kompatiblen (Java Transaction API) Transaktions-Manager.</p>
				<p>Der JDBC-Treiber ist nahtlos in Microsoft Distributed
					Transaction Coordinator (MS DTC) integriert, um eine echte
					Unterstützung von verteilten Transaktionen mit SQL Server zu
					ermöglichen. Bei MS DTC handelt es sich um eine Funktion für
					verteilte Transaktionen, die von Microsoft für Microsoft
					Windows-Systeme bereitgestellt wird. MS DTC verwendet bewährte
					Transaktionsverarbeitungstechnologien von Microsoft, um
					XA-Funktionen wie das vollständige verteilte Protokoll für
					Zweiphasencommit und die Wiederherstellung von verteilten
					Transaktionen zu unterstützen.</p>
				<p>
					Weitere Informationen zur Verwendung von verteilten Transaktionen
					finden Sie unter <span sdata="link"><a
						href="574e326f-0520-4003-bdf1-62d92c3db457.htm">Grundlegendes
							zu XA-Transaktionen</a></span>.
				</p>
			</div>
			<span id="seeAlsoSpan"><h1 class="heading">Siehe auch</h1></span>
			<div id="seeAlsoSection" class="section" name="collapseableSection"
				style="">
				<div class="seeAlsoStyle">
					<span sdata="link"><a
						href="afbb776f-05dc-4e79-bb25-2c340483e401.htm">Ausführen von
							Transaktionen mit dem JDBC-Treiber</a></span>
				</div>
			</div>
		</div>
		<div id="footer" class="section">
			<span id="feedbackarea">Senden Sie Microsoft <a
				href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dVielen%20Dank%20für%20Ihr%20Feedback.%20Die%20Autorenteams%20im%20Bereich%20Entwicklung%20nutzen%20Ihr%20Feedback,%20um%20die%20Dokumentation%20zu%20verbessern.%20Im%20Rahmen%20der%20Überprüfung%20Ihres%20Feedbacks%20erhalten%20Sie%20von%20uns%20ggf.%20eine%20E-Mail%20mit%20Rückfragen%20oder%20Feedback%20zur%20möglichen%20Lösung.%20Ihre%20E-Mail-Adresse%20wird%20von%20uns%20nicht%20zu%20anderen%20Zwecken%20verwendet%20und%20wird%20gelöscht,%20sobald%20die%20Überprüfung%20Ihres%20Feedbacks%20abgeschlossen%20ist.%0\AWeitere%20Informationen%20zu%20den%20Datenschutzrichtlinien%20von%20Microsoft%20finden%20Sie%20unter%20http://privacy.microsoft.com/de-de/default.aspx.%0\A%0\d','Kundenfeedback');">Feedback</a>
				zu diesem Thema.
			</span><span id="copyrightarea"><p>
					<a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012
						Microsoft. Alle Rechte vorbehalten.</a>
				</p></span>
		</div>
	</div>
</body>
</html>