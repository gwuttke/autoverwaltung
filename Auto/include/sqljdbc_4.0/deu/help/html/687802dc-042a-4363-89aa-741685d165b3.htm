<html xmlns:xlink="http://www.w3.org/1999/xlink"
	xmlns:MSHelp="http://msdn.microsoft.com/mshelp"
	xmlns:mshelp="http://msdn.microsoft.com/mshelp"
	xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5"
	xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" />
<META NAME="save" CONTENT="history" />
<title>Herstellen von Verbindungen mit SQL Server mit der
	integrierten Kerberos-Authentifizierung</title>
<meta name="Language" content="de-de" />
<meta name="Microsoft.Help.Id"
	content="687802dc-042a-4363-89aa-741685d165b3" />
<meta name="Description" content="Ab Microsoft JDBC Driver 4." />
<meta name="Microsoft.Help.ContentType" content="Concepts" />
<link rel="stylesheet" type="text/css" href="../local/Classic.css" />
<script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script>
<script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script>
</head>
<body>
	<div id="header">
		<table id="bottomTable" cellpadding="0" cellspacing="0">
			<tr>
				<td align="left"><span id="headerBold">Herstellen von
						Verbindungen mit SQL Server mit der integrierten
						Kerberos-Authentifizierung</span></td>
			</tr>
		</table>
		<table id="gradientTable">
			<tr>
				<td class="nsrBottom" background="../icons/gradient.gif" />
			</tr>
		</table>
	</div>
	<div id="mainSection">
		<div id="mainBody">
			<div class="introduction">
				<p>
					Ab Microsoft JDBC Driver 4.0 für SQL Server können Anwendungen
					mithilfe der <span sdata="langKeyword" value="authenticationScheme"><span
						class="keyword">authenticationScheme</span></span>-Verbindungseigenschaft
					angeben, dass eine Verbindung mit einer Datenbank unter Verwendung
					der integrierten Kerberos-Authentifizierung Typ 4 hergestellt
					werden soll. Weitere Informationen zu Verbindungseigenschaften
					finden Sie unter <span sdata="link"><a
						href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">Festlegen von
							Verbindungseigenschaften</a></span>. Weitere Informationen zu Kerberos
					finden Sie unter <a
						href="http://go.microsoft.com/fwlink/?LinkId=101449">Technischer
						Anhang zu Kerberos für Windows</a> und <a
						href="http://go.microsoft.com/fwlink/?LinkID=100758">Microsoft
						Kerberos</a>.
				</p>
				<p>
					Bei Verwendung der integrierten Authentifizierung mit dem Java-<span
						sdata="langKeyword" value="Krb5LoginModule"><span
						class="keyword">Krb5LoginModule</span></span> können Sie das Modul
					mithilfe der <a
						href="http://download.oracle.com/javase/1.5.0/docs/guide/security/jaas/spec/com/sun/security/auth/module/Krb5LoginModule.html">Krb5LoginModule-Klasse</a>
					konfigurieren.
				</p>
				<p>Microsoft JDBC Driver für SQL Server legt für Java-VMs von
					IBM die folgenden Eigenschaften fest:</p>
				<ul>
					<li><p>
							<span sdata="langKeyword" value="useDefaultCcache = true"><span
								class="keyword">useDefaultCcache = true</span></span>
						</p></li>
					<li><p>
							<span sdata="langKeyword" value="moduleBanner = false"><span
								class="keyword">moduleBanner = false</span></span>
						</p></li>
				</ul>
				<p>Microsoft JDBC Driver für SQL Server legt für alle anderen
					Java-VMs die folgenden Eigenschaften fest:</p>
				<ul>
					<li><p>
							<span sdata="langKeyword" value="useTicketCache = true"><span
								class="keyword">useTicketCache = true</span></span>
						</p></li>
					<li><p>
							<span sdata="langKeyword" value="doNotPrompt = true"><span
								class="keyword">doNotPrompt = true</span></span>
						</p></li>
				</ul>
			</div>
			<h1 class="heading">Hinweise</h1>
			<div id="sectionSection0" class="section" name="collapseableSection"
				style="">
				<p>
					Vor Microsoft JDBC Driver 4.0 für SQL Server konnten Anwendungen
					die integrierte Authentifizierung (mit Kerberos oder NTLM, je nach
					Verfügbarkeit) mithilfe der <span sdata="langKeyword"
						value="integratedSecurity"><span class="keyword">integratedSecurity</span></span>-Verbindungseigenschaft
					und durch Verweisen auf <span sdata="langKeyword"
						value="sqljdbc_auth.dll"><span class="keyword">sqljdbc_auth.dll</span></span>
					angeben, entsprechend der Beschreibung in <span sdata="link"><a
						href="44996746-d373-4f59-9863-a8a20bb8024a.htm">Erstellen der
							Verbindungs-URL</a></span>.
				</p>
				<p>
					Ab Microsoft JDBC Driver 4.0 für SQL Server können Anwendungen mit
					der <span sdata="langKeyword" value="authenticationScheme"><span
						class="keyword">authenticationScheme</span></span>-Verbindungseigenschaft
					angeben, dass eine Verbindung mit einer Datenbank mithilfe der
					integrierten Kerberos-Authentifizierung hergestellt werden soll,
					unter Verwendung der reinen Java-Kerberos-Implementierung:
				</p>
				<ul>
					<li><p>
							Wenn die integrierte Authentifizierung mit dem <span
								sdata="langKeyword" value="Krb5LoginModule"><span
								class="keyword">Krb5LoginModule</span></span> ausgeführt werden soll,
							müssen Sie dennoch die <span sdata="langKeyword"
								value="integratedSecurity=true"><span class="keyword">integratedSecurity=true</span></span>-Verbindungseigenschaft
							angeben. In diesem Fall geben Sie auch die <span
								sdata="langKeyword" value="authenticationScheme=JavaKerberos"><span
								class="keyword">authenticationScheme=JavaKerberos</span></span>-Verbindungseigenschaft
							an.
						</p></li>
					<li><p>
							Wenn weiterhin die integrierte Authentifizierung mit <span
								sdata="langKeyword" value="sqljdbc_auth.dll"><span
								class="keyword">sqljdbc_auth.dll</span></span> verwendet werden soll,
							geben Sie einfach die <span sdata="langKeyword"
								value="integratedSecurity=true"><span class="keyword">integratedSecurity=true</span></span>-Verbindungseigenschaft
							(und optional <span sdata="langKeyword"
								value="authenticationScheme=NativeAuthentication"><span
								class="keyword">authenticationScheme=NativeAuthentication</span></span>)
							an.
						</p></li>
					<li><p>
							Wenn Sie <span sdata="langKeyword"
								value="authenticationScheme=JavaKerberos"><span
								class="keyword">authenticationScheme=JavaKerberos</span></span>
							angeben, jedoch nicht gleichzeitig <span sdata="langKeyword"
								value="integratedSecurity=true"><span class="keyword">integratedSecurity=true</span></span>
							angeben, ignoriert der Treiber die <span sdata="langKeyword"
								value="authenticationScheme"><span class="keyword">authenticationScheme</span></span>-Verbindungseigenschaft,
							und es wird davon ausgegangen, dass Benutzername und Kennwort für
							die Anmeldeinformationen in der Verbindungszeichenfolge enthalten
							sind.
						</p></li>
				</ul>
				<p>
					Werden Verbindungen mit einer Datenquelle erstellt, können Sie das
					Authentifizierungsschema programmgesteuert mit <a
						href="b942f78e-7ce1-44ef-923d-a7c3d7c76b83.htm">setAuthenticationScheme</a>
					festlegen.
				</p>
				<p>
					Zur Unterstützung der Kerberos-Authentifizierung wurde eine neue
					Protokollierung eingeführt:
					com.microsoft.sqlserver.jdbc.internals.KerbAuthentication. Weitere
					Informationen finden Sie unter <span sdata="link"><a
						href="723aeae7-6504-4585-ba8b-3525115bea8b.htm">Ablaufverfolgung
							für Treibervorgänge</a></span>.
				</p>
				<p>Befolgen Sie beim Konfigurieren von Kerberos die folgenden
					Richtlinien:</p>
				<ol>
					<li><p>
							Legen Sie <span sdata="langKeyword" value="AllowTgtSessionKey"><span
								class="keyword">AllowTgtSessionKey</span></span> in der Registrierung
							für Windows auf 1 fest. Weitere Informationen finden Sie unter <a
								href="http://support.microsoft.com/kb/837361">KDC-Konfigurationsschlüssel
								in Windows Server 2003 und
								Kerberos-Protokoll-Registrierungseinträge</a>.
						</p></li>
					<li><p>Stellen Sie sicher, dass die Kerberos-Konfiguration
							(krb5.conf in UNIX-Umgebungen) auf den richtigen Bereich und KDC
							für Ihre Umgebung zeigt.</p></li>
					<li><p>Initialisieren Sie den TGT-Cache mit "kinit" oder
							indem Sie sich bei der Domäne anmelden.</p></li>
					<li><p>
							Bei Ausführung einer Anwendung, die <span sdata="langKeyword"
								value="authenticationScheme=JavaKerberos"><span
								class="keyword">authenticationScheme=JavaKerberos</span></span>
							verwendet, unter dem Betriebssystem Windows Vista bzw. Windows 7
							muss ein Standardbenutzerkonto verwendet werden. Wenn Sie jedoch
							die Anwendung unter einem Administratorkonto ausführen, muss sie
							mit Administratorberechtigungen ausgeführt werden.
						</p></li>
				</ol>
			</div>
			<h1 class="heading">Dienstprinzipalnamen</h1>
			<div id="sectionSection1" class="section" name="collapseableSection"
				style="">
				<p>Anhand eines Dienstprinzipalnamens (Service Principal Name,
					SPN) identifiziert ein Client eine Instanz eines Dienstes
					eindeutig. Weitere Informationen zu Dienstprinzipalnamen (SPNs)
					finden Sie in folgendem Thema:</p>
				<ul>
					<li><p>
							<a href="http://support.microsoft.com/kb/319723">Verwenden
								der Kerberos-Authentifizierung in SQL Server</a>
						</p></li>
					<li><p>
							<a href="http://go.microsoft.com/fwlink/?LinkId=207814">Verwenden
								von Kerberos mit SQL Server</a>
						</p></li>
				</ul>
			</div>
			<h1 class="heading">Erstellen einer
				Anmeldemodul-Konfigurationsdatei</h1>
			<div id="sectionSection2" class="section" name="collapseableSection"
				style="">
				<p>Sie können optional eine Kerberos-Konfigurationsdatei
					angeben. Wenn keine Konfigurationsdatei angegeben wird, gelten die
					folgenden Einstellungen:</p>
				<dl class="authored">
					<dt>Sun-JVM</dt>
					<dd>
						<p>com.sun.security.auth.module.Krb5LoginModule required
							useTicketCache=true doNotPrompt=true;</p>
					</dd>
					<dt>IBM-JVM</dt>
					<dd>
						<p>com.ibm.security.auth.module.Krb5LoginModule required
							useDefaultCcache = true moduleBanner = false;</p>
					</dd>
				</dl>
				<p>Wenn Sie selbstständig eine Anmeldemodul-Konfigurationsdatei
					erstellen, muss die Datei das folgende Format aufweisen:</p>
				<div class="sampleCode">
					<span codeLanguage="other"><pre>&lt;<i>name</i>&gt; {
    &lt;<i>LoginModule</i>&gt; &lt;<i>flag</i>&gt; &lt;<i>LoginModule options</i>&gt;;
    &lt;<i>optional_additional_LoginModules</i>, <i>flags_and_options</i>&gt;;
};</pre></span>
				</div>
				<p>Eine Anmeldemodul-Konfigurationsdatei enthält einen oder
					mehrere Einträge, die jeweils angeben, welche zugrunde liegende
					Authentifizierungstechnologie für eine bestimmte Anwendung bzw. für
					bestimmte Anwendungen verwendet werden soll. Beispiel:</p>
				<div class="sampleCode">
					<span codeLanguage="other"><pre>SQLJDBCDriver {
   com.sun.security.auth.module.Krb5LoginModule required useTicketCache=true doNotPrompt=true;
};</pre></span>
				</div>
				<p>Jeder Eintrag der Anmeldemodul-Konfigurationsdatei besteht
					aus einem Namen, auf den ein oder mehrere LoginModule-spezifische
					Einträge folgen. Jeder LoginModule-spezifische Eintrag wird jeweils
					durch ein Semikolon abgeschlossen, und die gesamte Gruppe von
					LoginModule-spezifischen Einträgen wird von geschweiften Klammern
					umschlossen. Jeder Konfigurationsdateieintrag wird durch ein
					Semikolon abgeschlossen.</p>
				<p>Für den Treiber kann nicht nur festgelegt werden, dass
					Kerberos-Anmeldeinformationen mit den Einstellungen in der
					Anmeldemodul-Konfigurationsdatei erhalten werden können.
					Stattdessen kann der Treiber auch vorhandene Anmeldeinformationen
					verwenden. Dies kann hilfreich sein, wenn die Anwendung
					Verbindungen mit den Anmeldeinformationen mehrerer Benutzer
					herstellen muss.</p>
				<p>Der Treiber versucht zunächst vorhandene Anmeldeinformationen
					zu verwenden (sofern diese verfügbar sind), bevor er die Anmeldung
					mit dem angegebenen Anmeldemodul ausführt. Bei Ausführung von Code
					unter einem bestimmten Kontext mithilfe der Subject.doAs-Methode
					wird daher eine Verbindung mit den Anmeldeinformationen erstellt,
					die an den Aufruf von Subject.doAs übergeben werden.</p>
				<p>
					Weitere Informationen finden Sie unter <a
						href="http://download.oracle.com/javase/1.4.2/docs/guide/security/jaas/tutorials/LoginConfigFile.html">JAAS
						Login Configuration File</a> und <a
						href="http://download.oracle.com/javase/1.5.0/docs/guide/security/jgss/tutorials/KerberosReq.html">Class
						Krb5LoginModule</a>.
				</p>
			</div>
			<h1 class="heading">Erstellen einer Kerberos-Konfigurationsdatei</h1>
			<div id="sectionSection3" class="section" name="collapseableSection"
				style="">
				<p>
					Weitere Informationen zu Kerberos-Konfigurationsdateien finden Sie
					unter <a
						href="http://download.oracle.com/javase/1.4.2/docs/guide/security/jaas/tutorials/LoginConfigFile.html">Kerberos
						Requirements</a>.
				</p>
				<p>Dies ist eine Konfiguration für eine Beispieldomäne. YYYY und
					ZZZZ sind durch die Domänennamen an Ihrem Standort zu ersetzen.</p>
				<div class="sampleCode">
					<span codeLanguage="other"><pre>[libdefaults]
default_realm = YYYY.CORP.CONTOSO.COM
dns_lookup_realm = false
dns_lookup_kdc = true
ticket_lifetime = 24h
forwardable = yes

[domain_realm]
.yyyy.corp.contoso.com = YYYY.CORP.CONTOSO.COM
.zzzz.corp.contoso.com = ZZZZ.CORP.CONTOSO.COM

[realms]
        YYYY.CORP.CONTOSO.COM = {
  kdc = krbtgt/YYYY.CORP. CONTOSO.COM @ YYYY.CORP. CONTOSO.COM
  default_domain = YYYY.CORP. CONTOSO.COM
}

        ZZZZ.CORP. CONTOSO.COM = {
  kdc = krbtgt/ZZZZ.CORP. CONTOSO.COM @ ZZZZ.CORP. CONTOSO.COM
  default_domain = ZZZZ.CORP. CONTOSO.COM
}
</pre></span>
				</div>
			</div>
			<h1 class="heading">Aktivieren der Domänenkonfigurationsdatei
				und der Anmeldemodul-Konfigurationsdatei</h1>
			<div id="sectionSection4" class="section" name="collapseableSection"
				style="">
				<p>
					Sie können eine Domänenkonfigurationsdatei mit
					-Djava.security.krb5.conf aktivieren. Sie können eine
					Anmeldemodul-Konfigurationsdatei mit <span sdata="langKeyword"
						value="-Djava.security.auth.login.config"><span
						class="keyword">-Djava.security.auth.login.config</span></span>
					aktivieren.
				</p>
				<p>Sie können beispielsweise beim Starten der Anwendung
					Folgendes an der Befehlszeile eingeben:</p>
				<div class="sampleCode">
					<span codeLanguage="other"><pre>Java.exe -Djava.security.auth.login.config=SQLJDBCDriver.conf -Djava.security.krb5.conf=krb5.ini &lt;<i>APPLICATION_NAME</i>&gt;
</pre></span>
				</div>
			</div>
			<h1 class="heading">Überprüfen des Zugriffs auf SQL Server über
				Kerberos</h1>
			<div id="sectionSection5" class="section" name="collapseableSection"
				style="">
				<p>Führen Sie in SQL Server Management Studio die folgende
					Abfrage aus:</p>
				<p>
					<span sdata="langKeyword"
						value="select auth_scheme from sys.dm_exec_connections where session_id=@@spid"><span
						class="keyword">select auth_scheme from
							sys.dm_exec_connections where session_id=@@spid</span></span>
				</p>
				<p>Vergewissern Sie sich, dass Sie über die erforderliche
					Berechtigung zum Ausführen dieser Abfrage verfügen.</p>
			</div>
			<span id="seeAlsoSpan"><h1 class="heading">Siehe auch</h1></span>
			<div id="seeAlsoSection" class="section" name="collapseableSection"
				style="">
				<div class="seeAlsoStyle">
					<span sdata="link"><a
						href="94bcfbe3-f00e-4774-bda8-bb7577518fec.htm">Verbinden von
							SQL Server mit dem JDBC-Treiber</a></span>
				</div>
			</div>
		</div>
		<div id="footer" class="section">
			<span id="feedbackarea">Senden Sie Microsoft <a
				href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dVielen%20Dank%20für%20Ihr%20Feedback.%20Die%20Autorenteams%20im%20Bereich%20Entwicklung%20nutzen%20Ihr%20Feedback,%20um%20die%20Dokumentation%20zu%20verbessern.%20Im%20Rahmen%20der%20Überprüfung%20Ihres%20Feedbacks%20erhalten%20Sie%20von%20uns%20ggf.%20eine%20E-Mail%20mit%20Rückfragen%20oder%20Feedback%20zur%20möglichen%20Lösung.%20Ihre%20E-Mail-Adresse%20wird%20von%20uns%20nicht%20zu%20anderen%20Zwecken%20verwendet%20und%20wird%20gelöscht,%20sobald%20die%20Überprüfung%20Ihres%20Feedbacks%20abgeschlossen%20ist.%0\AWeitere%20Informationen%20zu%20den%20Datenschutzrichtlinien%20von%20Microsoft%20finden%20Sie%20unter%20http://privacy.microsoft.com/de-de/default.aspx.%0\A%0\d','Kundenfeedback');">Feedback</a>
				zu diesem Thema.
			</span><span id="copyrightarea"><p>
					<a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012
						Microsoft. Alle Rechte vorbehalten.</a>
				</p></span>
		</div>
	</div>
</body>
</html>