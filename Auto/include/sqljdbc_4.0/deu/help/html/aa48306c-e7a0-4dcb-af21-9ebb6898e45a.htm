<html xmlns:xlink="http://www.w3.org/1999/xlink"
	xmlns:MSHelp="http://msdn.microsoft.com/mshelp"
	xmlns:mshelp="http://msdn.microsoft.com/mshelp"
	xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5"
	xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" />
<META NAME="save" CONTENT="history" />
<title>Verwenden der Haltbarkeit</title>
<meta name="Language" content="de-de" />
<meta name="System.Keywords" content="Transaktionshaltbarkeit" />
<meta name="Microsoft.Help.Id"
	content="aa48306c-e7a0-4dcb-af21-9ebb6898e45a" />
<meta name="Description"
	content="Standardmäßig bleibt ein Resultset, das in einer Transaktion erstellt wurde, nach einem Commit der Transaktion in der Datenbank oder einem Rollback geöffnet. Bisweilen ist es aber von Nutzen, das Resultset nach einem Commit der Transaktion zu schließen." />
<meta name="Microsoft.Help.ContentType" content="Concepts" />
<link rel="stylesheet" type="text/css" href="../local/Classic.css" />
<script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script>
<script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script>
</head>
<body>
	<div id="header">
		<table id="bottomTable" cellpadding="0" cellspacing="0">
			<tr>
				<td align="left"><span id="headerBold">Verwenden der
						Haltbarkeit</span></td>
			</tr>
		</table>
		<table id="gradientTable">
			<tr>
				<td class="nsrBottom" background="../icons/gradient.gif" />
			</tr>
		</table>
	</div>
	<div id="mainSection">
		<div id="mainBody">
			<div class="introduction">
				<p>Standardmäßig bleibt ein Resultset, das in einer Transaktion
					erstellt wurde, nach einem Commit der Transaktion in der Datenbank
					oder einem Rollback geöffnet. Bisweilen ist es aber von Nutzen, das
					Resultset nach einem Commit der Transaktion zu schließen. Zu diesem
					Zweck unterstützt Microsoft JDBC Driver für SQL Server die
					Verwendung der Resultsethaltbarkeit.</p>
				<p>
					Sie können die Resultsethaltbarkeit mit der <a
						href="552eebd0-4c38-43f0-961f-35244f99109b.htm">setHoldability</a>-Methode
					der <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>-Klasse
					einstellen. Beim Einstellen der Haltbarkeit mit der <b>setHoldability</b>-Methode
					können für die Resultsethaltbarkeit die Konstanten <b>ResultSet.HOLD_CURSORS_OVER_COMMIT</b>
					oder <b>ResultSet.CLOSE_CURSORS_AT_COMMIT</b> verwendet werden.
				</p>
				<p>Der JDBC-Treiber unterstützt auch das Festlegen der
					Haltbarkeit beim Erstellen eines der Statement-Objekte. Beim
					Erstellen der Statement-Objekte, die mit Parametern für die
					Resultsethaltbarkeit überladen sind, muss die Haltbarkeit des
					Statement-Objekts der Haltbarkeit der Verbindung entsprechen.
					Stimmen sie nicht überein, wird eine Ausnahme ausgelöst. Der Grund
					hierfür ist, dass SQL Server die Haltbarkeit nur auf
					Verbindungsebene unterstützt.</p>
				<p>
					Bei der Haltbarkeit eines Resultsets handelt es sich um die
					Haltbarkeit eines <b>SQLServerConnection</b>-Objekts, das nur beim
					Erstellen von serverseitigen Cursorn dem Resultset zugeordnet wird.
					Dies gilt nicht für clientseitige Cursor. Alle Resultsets mit
					clientseitigen Cursorn besitzen immer den Haltbarkeitswert <b>ResultSet.HOLD_CURSORS_OVER_COMMIT</b>.
				</p>
				<p>Wenn Servercursor mit SQL Server 2005 oder höher verbunden
					sind, wirkt sich das Festlegen der Haltbarkeit nur auf die
					Haltbarkeit neuer Resultsets aus, die erst noch für diese
					Verbindung erstellt werden. Das heißt, das Festlegen der
					Haltbarkeit hat keine Auswirkungen auf die Haltbarkeit von
					Resultsets, die zuvor erstellt wurden und für die Verbindung
					bereits geöffnet sind. Bei SQL Server 2000 wirkt sich das Festlegen
					der Haltbarkeit jedoch sowohl auf die Haltbarkeit vorhandener als
					auch neuer, noch für die Verbindung zu erstellender Resultsets aus.</p>
				<p>
					Im folgenden Beispiel wird die Resultsethaltbarkeit beim Ausführen
					einer lokalen Transaktion mit zwei getrennten Anweisungen im <span
						class="code">try</span>-Block eingestellt. Die Anweisungen werden
					für die Production.ScrapReason-Tabelle in der SQL Server
					2005-Beispieldatenbank AdventureWorks ausgeführt. Zunächst wird im
					Beispiel zum manuellen Transaktionsmodus gewechselt, indem die der
					automatische Commit auf <span sdata="langKeyword" value="false"><span
						class="keyword">false</span></span> festgelegt wird. Sobald der
					automatische Commitmodus deaktiviert ist, wird ein Commit von
					SQL-Anweisungen erst ausgeführt, wenn die die Anwendung die <a
						href="c7346165-51bf-4844-b64c-29833c147236.htm">commit</a>-Methode
					explizit aufruft. Der Code im catch-Block führt ein Rollback der
					Transaktion aus, wenn eine Ausnahme ausgelöst wird.
				</p>
				<div name="snippetGroup">
					<div class="sampleCode">
						<span codeLanguage="Java"><pre>public static void executeTransaction(Connection con) {
   try {
       con.setAutoCommit(false);
       con.setHoldability(ResultSet.HOLD_CURSORS_OVER_COMMIT);
       Statement stmt = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
       stmt.executeUpdate("INSERT INTO Production.ScrapReason(Name) VALUES('Bad part')");
       ResultSet rs = stmt.executeQuery("SELECT * FROM Production.ScrapReason");
       con.commit();
       System.out.println("Transaction succeeded.");

       //Display results.
       while (rs.next()) {
          System.out.println(rs.getString(2));
       }
       stmt.close();
      }
      catch (SQLException ex) {
         ex.printStackTrace();
         try {
            System.out.println("Transaction failed.");
            con.rollback();
         }
         catch (SQLException se) {
            se.printStackTrace();
         }
      }
   }
}

</pre></span>
					</div>
				</div>
			</div>
			<span id="seeAlsoSpan"><h1 class="heading">Siehe auch</h1></span>
			<div id="seeAlsoSection" class="section" name="collapseableSection"
				style="">
				<div class="seeAlsoStyle">
					<span sdata="link"><a
						href="afbb776f-05dc-4e79-bb25-2c340483e401.htm">Ausführen von
							Transaktionen mit dem JDBC-Treiber</a></span>
				</div>
			</div>
		</div>
		<div id="footer" class="section">
			<span id="feedbackarea">Senden Sie Microsoft <a
				href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dVielen%20Dank%20für%20Ihr%20Feedback.%20Die%20Autorenteams%20im%20Bereich%20Entwicklung%20nutzen%20Ihr%20Feedback,%20um%20die%20Dokumentation%20zu%20verbessern.%20Im%20Rahmen%20der%20Überprüfung%20Ihres%20Feedbacks%20erhalten%20Sie%20von%20uns%20ggf.%20eine%20E-Mail%20mit%20Rückfragen%20oder%20Feedback%20zur%20möglichen%20Lösung.%20Ihre%20E-Mail-Adresse%20wird%20von%20uns%20nicht%20zu%20anderen%20Zwecken%20verwendet%20und%20wird%20gelöscht,%20sobald%20die%20Überprüfung%20Ihres%20Feedbacks%20abgeschlossen%20ist.%0\AWeitere%20Informationen%20zu%20den%20Datenschutzrichtlinien%20von%20Microsoft%20finden%20Sie%20unter%20http://privacy.microsoft.com/de-de/default.aspx.%0\A%0\d','Kundenfeedback');">Feedback</a>
				zu diesem Thema.
			</span><span id="copyrightarea"><p>
					<a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012
						Microsoft. Alle Rechte vorbehalten.</a>
				</p></span>
		</div>
	</div>
</body>
</html>