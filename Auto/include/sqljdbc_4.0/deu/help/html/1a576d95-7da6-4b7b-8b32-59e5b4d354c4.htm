<html xmlns:xlink="http://www.w3.org/1999/xlink"
	xmlns:MSHelp="http://msdn.microsoft.com/mshelp"
	xmlns:mshelp="http://msdn.microsoft.com/mshelp"
	xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5"
	xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" />
<META NAME="save" CONTENT="history" />
<title>Ausführen von Batchoperationen</title>
<meta name="Language" content="de-de" />
<meta name="System.Keywords" content="Batchoperationen" />
<meta name="Microsoft.Help.Id"
	content="1a576d95-7da6-4b7b-8b32-59e5b4d354c4" />
<meta name="Description"
	content="Um die Leistung bei mehreren Updates einer SQL Server-Datenbank zu verbessern, bietet Microsoft JDBC Driver für SQL Server die Möglichkeit, mehrere Updates als einzelne Arbeitseinheit (auch Batch genannt) zu übermitteln." />
<meta name="Microsoft.Help.ContentType" content="Concepts" />
<link rel="stylesheet" type="text/css" href="../local/Classic.css" />
<script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script>
<script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script>
</head>
<body>
	<div id="header">
		<table id="bottomTable" cellpadding="0" cellspacing="0">
			<tr>
				<td align="left"><span id="headerBold">Ausführen von
						Batchoperationen</span></td>
			</tr>
		</table>
		<table id="gradientTable">
			<tr>
				<td class="nsrBottom" background="../icons/gradient.gif" />
			</tr>
		</table>
	</div>
	<div id="mainSection">
		<div id="mainBody">
			<div class="introduction">
				<p>Um die Leistung bei mehreren Updates einer SQL
					Server-Datenbank zu verbessern, bietet Microsoft JDBC Driver für
					SQL Server die Möglichkeit, mehrere Updates als einzelne
					Arbeitseinheit (auch Batch genannt) zu übermitteln.</p>
				<p>
					Zum Übermitteln von Batchupdates können die Klassen <a
						href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a>,
					<a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a>
					und <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a>
					verwendet werden. Mit der <a
						href="134f1455-c98c-4112-ab2d-9205a0db73df.htm">addBatch</a>-Methode
					können Sie einen Befehl hinzufügen. Mit der <a
						href="6e5cda26-e24d-4637-8dfd-8135ba126e3b.htm">clearBatch</a>-Methode
					können Sie die Liste der Befehle löschen. Mit der <a
						href="fb034f63-2532-4da8-a1b0-bc125734585a.htm">executeBatch</a>-Methode
					können Sie alle zu verarbeitenden Befehle übermitteln. In einem
					Batch können nur DDL- (Data Definition Language) und
					DML-Anweisungen (Data Manipulation Language) ausgeführt werden, die
					eine einfache Updatezählung zurückgeben.
				</p>
				<p>
					Die <b>executeBatch</b>-Methode gibt ein Array mit <span
						sdata="langKeyword" value="int"><span class="keyword">int</span></span>-Werten
					zurück, die der Updatezählung der einzelnen Befehle entsprechen.
					Wenn ein Befehl fehlschlägt, wird eine <b>BatchUpdateException</b>
					ausgegeben. Sie sollten dann mit der <b>getUpdateCounts</b>-Methode
					der <b>BatchUpdateException</b>-Klasse das Array mit den
					Updatezählungen abrufen. Wenn ein Befehl fehlschlägt, wird die
					Verarbeitung der restlichen Befehle vom Treiber fortgesetzt. Wenn
					ein Befehl einen Syntaxfehler enthält, schlagen die Anweisungen im
					Batch allerdings fehl.
				</p>
				<div style="margin: .5em 1.5em .5em 1.5em">
					<b></b>
					<p>Wenn keine Updatezählungen verwendet werden müssen, können
						Sie zuerst eine SET NOCOUNT ON-Anweisung an SQL Server ausgeben.
						Dadurch wird das Verkehrsaufkommen im Netzwerk verringert und
						zusätzlich die Leistung der Anwendung verbessert.</p>
				</div>
				<p>Erstellen Sie als Beispiel die folgende Tabelle in der SQL
					Server 2005 AdventureWorks-Beispieldatenbank:</p>
				<div class="sampleCode">
					<span codeLanguage="other"><pre>CREATE TABLE TestTable 
   (Col1 int IDENTITY, 
    Col2 varchar(50), 
    Col3 int);</pre></span>
				</div>
				<p>
					Im folgenden Beispiel werden eine offene Verbindung zur
					AdventureWorks-Beispieldatenbank an die Funktion übergeben, mit der
					<b>addBatch</b>-Methode werden die auszuführenden Anweisungen
					erstellt, und die <b>executeBatch</b>-Methode wird aufgerufen, um
					den Stapel an die Datenbank zu übermitteln.
				</p>
				<div class="sampleCode">
					<span codeLanguage="other"><pre>public static void executeBatchUpdate(Connection con) {
   try {
      Statement stmt = con.createStatement();
      stmt.addBatch("INSERT INTO TestTable (Col2, Col3) VALUES ('X', 100)");
      stmt.addBatch("INSERT INTO TestTable (Col2, Col3) VALUES ('Y', 200)");
      stmt.addBatch("INSERT INTO TestTable (Col2, Col3) VALUES ('Z', 300)");
      int[] updateCounts = stmt.executeBatch();
      stmt.close();
   }
   catch (Exception e) {
      e.printStackTrace();
   }
}</pre></span>
				</div>
			</div>
			<span id="seeAlsoSpan"><h1 class="heading">Siehe auch</h1></span>
			<div id="seeAlsoSection" class="section" name="collapseableSection"
				style="">
				<div class="seeAlsoStyle">
					<span sdata="link"><a
						href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Verwenden von
							Anweisungen mit dem JDBC-Treiber</a></span>
				</div>
			</div>
		</div>
		<div id="footer" class="section">
			<span id="feedbackarea">Senden Sie Microsoft <a
				href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dVielen%20Dank%20für%20Ihr%20Feedback.%20Die%20Autorenteams%20im%20Bereich%20Entwicklung%20nutzen%20Ihr%20Feedback,%20um%20die%20Dokumentation%20zu%20verbessern.%20Im%20Rahmen%20der%20Überprüfung%20Ihres%20Feedbacks%20erhalten%20Sie%20von%20uns%20ggf.%20eine%20E-Mail%20mit%20Rückfragen%20oder%20Feedback%20zur%20möglichen%20Lösung.%20Ihre%20E-Mail-Adresse%20wird%20von%20uns%20nicht%20zu%20anderen%20Zwecken%20verwendet%20und%20wird%20gelöscht,%20sobald%20die%20Überprüfung%20Ihres%20Feedbacks%20abgeschlossen%20ist.%0\AWeitere%20Informationen%20zu%20den%20Datenschutzrichtlinien%20von%20Microsoft%20finden%20Sie%20unter%20http://privacy.microsoft.com/de-de/default.aspx.%0\A%0\d','Kundenfeedback');">Feedback</a>
				zu diesem Thema.
			</span><span id="copyrightarea"><p>
					<a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012
						Microsoft. Alle Rechte vorbehalten.</a>
				</p></span>
		</div>
	</div>
</body>
</html>