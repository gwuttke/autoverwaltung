<html xmlns:xlink="http://www.w3.org/1999/xlink"
	xmlns:MSHelp="http://msdn.microsoft.com/mshelp"
	xmlns:mshelp="http://msdn.microsoft.com/mshelp"
	xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5"
	xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" />
<META NAME="save" CONTENT="history" />
<title>Verwenden von gespeicherten Prozeduren mit
	Eingabeparametern</title>
<meta name="Language" content="de-de" />
<meta name="Microsoft.Help.Id"
	content="8f491b70-7d1b-42bd-964f-9a8b86af5eaa" />
<meta name="Description"
	content="Eine aufrufbare gespeicherte SQL Server-Prozedur enthält mindestens einen IN-Parameter, über den Daten an die gespeicherte Prozedur übergeben werden können." />
<meta name="Microsoft.Help.ContentType" content="Concepts" />
<link rel="stylesheet" type="text/css" href="../local/Classic.css" />
<script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script>
<script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script>
<script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script>
</head>
<body>
	<div id="header">
		<table id="bottomTable" cellpadding="0" cellspacing="0">
			<tr>
				<td align="left"><span id="headerBold">Verwenden von
						gespeicherten Prozeduren mit Eingabeparametern</span></td>
			</tr>
		</table>
		<table id="gradientTable">
			<tr>
				<td class="nsrBottom" background="../icons/gradient.gif" />
			</tr>
		</table>
	</div>
	<div id="mainSection">
		<div id="mainBody">
			<div class="introduction">
				<p>
					Eine aufrufbare gespeicherte SQL Server-Prozedur enthält mindestens
					einen IN-Parameter, über den Daten an die gespeicherte Prozedur
					übergeben werden können. Microsoft JDBC Driver für SQL Server
					enthält die <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a>-Klasse,
					mit der Sie diese Art von gespeicherter Prozedur aufrufen und die
					zurückgegebenen Daten verarbeiten können.
				</p>
				<p>
					Wenn Sie eine gespeicherte Prozedur mit IN-Parametern mit dem
					JDBC-Treiber aufrufen, müssen Sie die <span class="code">
						call </span>-SQL-Escapesequenz zusammen mit der <a
						href="265b024c-898a-4bd0-98b5-f06076717b9e.htm">prepareCall</a>-Methode
					der <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>-Klasse
					verwenden. Die Syntax für die <span class="code"> call </span>-Escapesequenz
					mit IN-Parameter lautet wie folgt:
				</p>
				<p>
					<span class="code">{call
						procedure-name[([parameter][,[parameter]]...)]}</span>
				</p>
				<div style="margin: .5em 1.5em .5em 1.5em">
					<b></b>
					<p>
						Weitere Informationen zu SQL-Escapesequenzen finden Sie unter <span
							sdata="link"><a
							href="00f9e25a-088e-4ac6-aa75-43eacace8f03.htm">Verwenden von
								SQL-Escapesequenzen</a></span>.
					</p>
				</div>
				<p>
					Geben Sie die IN-Parameter beim Erstellen der <span class="code">
						call </span>-Escapesequenz mit dem Fragezeichen (?) an. das als
					Platzhalter für die Parameterwerte fungiert, die an die
					gespeicherte Prozedur übergeben werden. Mit den Festlegungsmethoden
					der <b>SQLServerPreparedStatement</b>-Klasse können Sie für einen
					Parameter einen Wert angeben. Die verwendbare Festlegungsmethode
					hängt vom Datentyp des IN-Parameters ab.
				</p>
				<p>Wenn Sie einen Wert an die Festlegungsmethode übergeben,
					müssen Sie nicht nur den Wert angeben, der im Parameter verwendet
					wird, sondern auch die ordinale Position des Parameters in der
					gespeicherten Prozedur. Wenn die gespeicherte Prozedur
					beispielsweise einen einzigen IN-Parameter enthält, ist der
					Ordinalwert "1". Wenn die gespeicherte Prozedur zwei Parameter
					enthält, ist der erste Ordinalwert "1" und der zweite Ordinalwert
					"2".</p>
				<p>Ein Beispiel für den Aufruf einer gespeicherten Prozedur mit
					einem IN-Parameter enthält die gespeicherte Prozedur
					"uspGetEmployeeManagers" in der SQL Server 2005
					AdventureWorks-Beispieldatenbank. Diese gespeicherte Prozedur
					übernimmt einen einzelnen Eingabeparameter mit dem Namen
					"EmployeeID" (integer-Wert) und gibt abhängig von der angegebenen
					"EmployeeID" eine rekursive Liste der Mitarbeiter und deren
					Vorgesetzten zurück. Der Java-Code für den Aufruf dieser
					gespeicherten Prozedur sieht folgendermaßen aus:</p>
				<div class="sampleCode">
					<span codeLanguage="other"><pre>public static void executeSprocInParams(Connection con) {
   try {
      PreparedStatement pstmt = con.prepareStatement("{call dbo.uspGetEmployeeManagers(?)}");
      pstmt.setInt(1, 50);
      ResultSet rs = pstmt.executeQuery();

      while (rs.next()) {
         System.out.println("EMPLOYEE:");
         System.out.println(rs.getString("LastName") + ", " + rs.getString("FirstName"));
         System.out.println("MANAGER:");
         System.out.println(rs.getString("ManagerLastName") + ", " + rs.getString("ManagerFirstName"));
         System.out.println();
      }
      rs.close();
      pstmt.close();
   }

   catch (Exception e) {
      e.printStackTrace();
    }
}</pre></span>
				</div>
			</div>
			<span id="seeAlsoSpan"><h1 class="heading">Siehe auch</h1></span>
			<div id="seeAlsoSection" class="section" name="collapseableSection"
				style="">
				<div class="seeAlsoStyle">
					<span sdata="link"><a
						href="0041f9e1-09b6-4487-b052-afd636c8e89a.htm">Verwenden von
							Anweisungen mit gespeicherten Prozeduren</a></span>
				</div>
			</div>
		</div>
		<div id="footer" class="section">
			<span id="feedbackarea">Senden Sie Microsoft <a
				href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dVielen%20Dank%20für%20Ihr%20Feedback.%20Die%20Autorenteams%20im%20Bereich%20Entwicklung%20nutzen%20Ihr%20Feedback,%20um%20die%20Dokumentation%20zu%20verbessern.%20Im%20Rahmen%20der%20Überprüfung%20Ihres%20Feedbacks%20erhalten%20Sie%20von%20uns%20ggf.%20eine%20E-Mail%20mit%20Rückfragen%20oder%20Feedback%20zur%20möglichen%20Lösung.%20Ihre%20E-Mail-Adresse%20wird%20von%20uns%20nicht%20zu%20anderen%20Zwecken%20verwendet%20und%20wird%20gelöscht,%20sobald%20die%20Überprüfung%20Ihres%20Feedbacks%20abgeschlossen%20ist.%0\AWeitere%20Informationen%20zu%20den%20Datenschutzrichtlinien%20von%20Microsoft%20finden%20Sie%20unter%20http://privacy.microsoft.com/de-de/default.aspx.%0\A%0\d','Kundenfeedback');">Feedback</a>
				zu diesem Thema.
			</span><span id="copyrightarea"><p>
					<a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012
						Microsoft. Alle Rechte vorbehalten.</a>
				</p></span>
		</div>
	</div>
</body>
</html>